{
  "openapi": "3.0.0",
  "info": {
    "title": "FL Copro API",
    "version": "1.0.0",
    "description": "API de gestion de copropriétés FL Copro - Documentation complète des endpoints",
    "contact": {
      "name": "FL Copro Support"
    }
  },
  "servers": [
    {
      "url": "/api",
      "description": "API Server"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Token JWT d'authentification. Format: Bearer {token}"
      }
    },
    "schemas": {
      "Address": {
        "type": "object",
        "properties": {
          "streets": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Liste des lignes d'adresse",
            "example": [
              "123 Rue de la Paix",
              "Bâtiment A"
            ]
          },
          "city": {
            "type": "string",
            "description": "Ville",
            "example": "Paris"
          },
          "zipCode": {
            "type": "string",
            "description": "Code postal",
            "example": "75001"
          },
          "country": {
            "type": "string",
            "description": "Pays",
            "example": "France"
          }
        },
        "required": [
          "streets",
          "city",
          "zipCode",
          "country"
        ]
      },
      "Resident": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID unique du résident",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "firstname": {
            "type": "string",
            "description": "Prénom du résident",
            "example": "Jean"
          },
          "lastname": {
            "type": "string",
            "description": "Nom du résident",
            "example": "Dupont"
          },
          "email": {
            "type": "string",
            "description": "Email du résident",
            "example": "jean.dupont@email.com"
          },
          "active": {
            "type": "boolean",
            "description": "Statut actif du résident",
            "example": true
          }
        },
        "required": [
          "firstname",
          "lastname",
          "active"
        ]
      },
      "User": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID unique de l'utilisateur",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "firstname": {
            "type": "string",
            "description": "Prénom de l'utilisateur",
            "example": "Marie"
          },
          "lastname": {
            "type": "string",
            "description": "Nom de l'utilisateur",
            "example": "Martin"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email de l'utilisateur",
            "example": "marie.martin@flcopro.com"
          },
          "password": {
            "type": "string",
            "format": "password",
            "description": "Mot de passe (hashé en base)",
            "example": "MonMotDePasse123!"
          },
          "role": {
            "type": "string",
            "enum": [
              "Admin",
              "Gestionnaire"
            ],
            "description": "Rôle de l'utilisateur",
            "example": "Gestionnaire"
          },
          "active": {
            "type": "boolean",
            "description": "Compte actif ou non",
            "example": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Date de création du compte"
          },
          "lastActive": {
            "type": "string",
            "format": "date-time",
            "description": "Dernière activité de l'utilisateur"
          },
          "avatar": {
            "type": "string",
            "description": "Avatar en base64 ou URL",
            "example": "data:image/svg+xml;base64,..."
          },
          "pinnedCondominiums": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Liste des IDs de copropriétés épinglées",
            "example": [
              "650f8c4d8b8c4f0012345678"
            ]
          }
        },
        "required": [
          "firstname",
          "lastname",
          "email",
          "password",
          "role"
        ]
      },
      "UserResponse": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string"
          },
          "firstname": {
            "type": "string"
          },
          "lastname": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "role": {
            "type": "string",
            "enum": [
              "Admin",
              "Gestionnaire"
            ]
          },
          "active": {
            "type": "boolean"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "lastActive": {
            "type": "string",
            "format": "date-time"
          },
          "avatar": {
            "type": "string"
          },
          "pinnedCondominiums": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "Condominium": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID unique de la copropriété",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "photo": {
            "type": "string",
            "description": "Photo de la copropriété (ID GridFS ou URL)",
            "example": "650f8c4d8b8c4f0012345679"
          },
          "code": {
            "type": "string",
            "description": "Code unique de la copropriété",
            "example": "CPR-001"
          },
          "name": {
            "type": "string",
            "description": "Nom de la copropriété",
            "example": "Résidence Les Oliviers"
          },
          "foundedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Date de fondation de la copropriété"
          },
          "address": {
            "$ref": "#/components/schemas/Address"
          },
          "residents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Resident"
            },
            "description": "Liste des résidents de la copropriété"
          }
        },
        "required": [
          "code",
          "name",
          "address"
        ]
      },
      "Report": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID unique du rapport",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "title": {
            "type": "string",
            "description": "Titre du rapport",
            "example": "Visite annuelle 2024"
          },
          "date": {
            "type": "string",
            "format": "date-time",
            "description": "Date du rapport"
          },
          "type": {
            "type": "string",
            "description": "Type de rapport",
            "enum": [
              "visit",
              "index",
              "reception",
              "sinister"
            ],
            "example": "visit"
          },
          "subType": {
            "type": "string",
            "description": "Sous-type optionnel du rapport",
            "example": "annual"
          },
          "redactor": {
            "type": "string",
            "description": "ID du rédacteur",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "redactorName": {
            "type": "string",
            "description": "Nom du rédacteur",
            "example": "Marie Martin"
          },
          "condominiumId": {
            "type": "string",
            "description": "ID de la copropriété associée",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "condominiumName": {
            "type": "string",
            "description": "Nom de la copropriété",
            "example": "Résidence Les Oliviers"
          },
          "address": {
            "$ref": "#/components/schemas/Address"
          },
          "foundedDate": {
            "type": "string",
            "format": "date-time",
            "description": "Date de fondation de la copropriété"
          },
          "image": {
            "type": "string",
            "description": "Image principale du rapport"
          },
          "state": {
            "type": "string",
            "enum": [
              "draft",
              "finalized"
            ],
            "description": "État du rapport",
            "example": "draft"
          },
          "residents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Resident"
            },
            "description": "Liste des résidents concernés"
          },
          "html": {
            "type": "string",
            "description": "ID GridFS du HTML pré-généré"
          },
          "elements": {
            "type": "array",
            "items": {
              "type": "object"
            },
            "description": "Éléments/sections du rapport"
          }
        },
        "required": [
          "title",
          "date",
          "type",
          "redactor",
          "redactorName",
          "condominiumId",
          "condominiumName",
          "address",
          "state"
        ]
      },
      "Role": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID unique du rôle",
            "example": "admin"
          },
          "name": {
            "type": "string",
            "enum": [
              "Admin",
              "Gestionnaire"
            ],
            "description": "Nom du rôle",
            "example": "Admin"
          },
          "description": {
            "type": "string",
            "description": "Description du rôle",
            "example": "Administrateur avec tous les droits"
          },
          "permissions": {
            "type": "object",
            "additionalProperties": {
              "type": "boolean"
            },
            "description": "Permissions du rôle",
            "example": {
              "canCreateUser": true,
              "canDeleteUser": true,
              "canEditCondominium": true
            }
          }
        },
        "required": [
          "name",
          "description",
          "permissions"
        ]
      },
      "LoginRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "example": "user@example.com"
          },
          "password": {
            "type": "string",
            "format": "password",
            "example": "mypassword"
          }
        },
        "required": [
          "email",
          "password"
        ]
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "JWT token",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "user": {
            "$ref": "#/components/schemas/UserResponse"
          }
        }
      },
      "ReportStructure": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Type de structure de rapport",
            "example": "visit"
          },
          "data": {
            "type": "object",
            "description": "Données de la structure du rapport"
          }
        },
        "required": [
          "type",
          "data"
        ]
      },
      "UploadedImage": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "ID de l'image dans GridFS",
            "example": "650f8c4d8b8c4f0012345678"
          },
          "filename": {
            "type": "string",
            "description": "Nom du fichier",
            "example": "photo_facade.jpg"
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Message d'erreur",
            "example": "Invalid credentials"
          },
          "details": {
            "type": "string",
            "description": "Détails additionnels de l'erreur"
          }
        }
      },
      "SuccessResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "message": {
            "type": "string",
            "example": "Operation completed successfully"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Status",
      "description": "Endpoints de statut de l'API"
    },
    {
      "name": "Auth",
      "description": "Authentification et gestion de compte"
    },
    {
      "name": "Users",
      "description": "Gestion des utilisateurs"
    },
    {
      "name": "Condominiums",
      "description": "Gestion des copropriétés"
    },
    {
      "name": "Reports",
      "description": "Gestion des rapports"
    },
    {
      "name": "Images",
      "description": "Gestion des images (GridFS)"
    },
    {
      "name": "Roles",
      "description": "Gestion des rôles et permissions"
    },
    {
      "name": "Report Structure",
      "description": "Structures de rapports"
    },
    {
      "name": "Miscellaneous",
      "description": "Utilitaires divers (PDF, VPS, etc.)"
    }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "summary": "Register a new user",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User registered successfully and returns JWT token and user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing required fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "Email already in use",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "summary": "Login with email and password",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful login returns JWT token and user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing email or password",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/me": {
      "get": {
        "summary": "Get the authenticated user's profile",
        "tags": [
          "Auth"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "The authenticated user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/change-password": {
      "post": {
        "summary": "Change the authenticated user's password",
        "tags": [
          "Auth"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "currentPassword",
                  "newPassword"
                ],
                "properties": {
                  "currentPassword": {
                    "type": "string",
                    "description": "Current password",
                    "example": "oldPassword123"
                  },
                  "newPassword": {
                    "type": "string",
                    "description": "New password",
                    "example": "newPassword456"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/profile": {
      "patch": {
        "summary": "Update authenticated user's profile",
        "tags": [
          "Auth"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "firstname": {
                    "type": "string",
                    "description": "First name",
                    "example": "Jean"
                  },
                  "lastname": {
                    "type": "string",
                    "description": "Last name",
                    "example": "Dupont"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "Email address",
                    "example": "jean.dupont@email.com"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "Admin",
                      "Gestionnaire"
                    ],
                    "description": "User role"
                  },
                  "avatar": {
                    "type": "string",
                    "description": "Avatar (base64 or URL)"
                  },
                  "pinnedCondominiums": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "List of pinned condominium IDs"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "No valid fields to update",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/request-verification": {
      "post": {
        "summary": "Request email verification",
        "tags": [
          "Auth"
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/verify-email": {
      "post": {
        "summary": "Verify email with a token",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string",
                    "description": "Verification token"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/forgot-password": {
      "post": {
        "summary": "Initiate password reset",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "email"
                ],
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "User email address",
                    "example": "user@example.com"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/reset-password": {
      "post": {
        "summary": "Reset password with token",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "token",
                  "newPassword"
                ],
                "properties": {
                  "token": {
                    "type": "string",
                    "description": "Password reset token"
                  },
                  "newPassword": {
                    "type": "string",
                    "description": "New password"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums": {
      "get": {
        "summary": "Get all condominiums",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of all condominiums",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Condominium"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/get": {
      "get": {
        "summary": "Get condominiums with a limit",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "Maximum number of condominiums to return"
          }
        ],
        "responses": {
          "200": {
            "description": "Limited list of condominiums",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Condominium"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid limit",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/count": {
      "get": {
        "summary": "Get number of condominiums",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Total count of condominiums",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {
                      "type": "integer",
                      "description": "Number of condominiums"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/codes": {
      "get": {
        "summary": "Get all condominium codes",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of condominium codes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/{id}/residents": {
      "get": {
        "summary": "Get residents of a condominium by ID",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          }
        ],
        "responses": {
          "200": {
            "description": "List of residents for the given condominium",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Resident"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents": {
      "get": {
        "summary": "Get all residents",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of all residents",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Resident"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/count": {
      "get": {
        "summary": "Get number of residents",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Total number of residents",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/{id}": {
      "get": {
        "summary": "Get condominium by ID",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Condominium details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Condominium"
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update condominium by ID",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Condominium"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Condominium updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Condominium"
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete condominium by ID",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Condominium deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/add": {
      "post": {
        "summary": "Add a condominium",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Condominium"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Condominium successfully added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Condominium"
                }
              }
            }
          },
          "400": {
            "description": "Invalid payload",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/seed": {
      "post": {
        "summary": "Seed the database with condominiums",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "201": {
            "description": "Seed completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/add": {
      "post": {
        "summary": "Add a resident to a condominium",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId",
                  "resident"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "ID of the condominium"
                  },
                  "resident": {
                    "$ref": "#/components/schemas/Resident"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Resident successfully added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Resident"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/import": {
      "post": {
        "summary": "Import residents from an Excel file to a condominium",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId",
                  "file"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "The ID of the condominium"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Excel file (.xls or .xlsx) containing residents data"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Residents successfully imported",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "imported": {
                      "type": "integer",
                      "description": "Number of residents imported"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or file format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/replace": {
      "post": {
        "summary": "Replace all residents in a condominium from an Excel file",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId",
                  "file"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "The ID of the condominium"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Excel file (.xls or .xlsx) containing residents data"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Residents successfully replaced",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "replaced": {
                      "type": "integer",
                      "description": "Number of residents replaced"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or file format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Condominium not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/update": {
      "patch": {
        "summary": "Update a resident",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId",
                  "residentId"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "ID of the condominium"
                  },
                  "residentId": {
                    "type": "string",
                    "description": "ID of the resident"
                  },
                  "firstname": {
                    "type": "string"
                  },
                  "lastname": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "active": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Resident updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Resident"
                }
              }
            }
          },
          "404": {
            "description": "Resident not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/condominiums/residents/remove": {
      "delete": {
        "summary": "Remove a resident from a condominium",
        "tags": [
          "Condominiums"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "condominiumId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          },
          {
            "in": "query",
            "name": "residentId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Resident ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Resident removed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "404": {
            "description": "Resident not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/images/orphans/stats": {
      "get": {
        "summary": "Get statistics about orphan images",
        "description": "Returns information about images in GridFS that are not referenced in any collection",
        "tags": [
          "Images"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Orphan images statistics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalReferencedImages": {
                      "type": "number",
                      "description": "Total number of referenced images"
                    },
                    "totalGridFSImages": {
                      "type": "number",
                      "description": "Total number of images in GridFS"
                    },
                    "orphanImagesCount": {
                      "type": "number",
                      "description": "Number of orphan images"
                    },
                    "orphanImages": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string"
                          },
                          "filename": {
                            "type": "string"
                          },
                          "size": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/images/orphans": {
      "delete": {
        "summary": "Delete all orphan images",
        "description": "Removes all images from GridFS that are not referenced in any collection",
        "tags": [
          "Images"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Orphan images deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "deletedCount": {
                      "type": "number"
                    },
                    "errorCount": {
                      "type": "number"
                    },
                    "errors": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/images/{id}": {
      "get": {
        "summary": "Get an image by ID",
        "tags": [
          "Images"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Image ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Image file stream",
            "content": {
              "image/*": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Invalid image ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Image not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete an image by ID",
        "tags": [
          "Images"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Image ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Image deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing image ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/images/upload": {
      "post": {
        "summary": "Upload an image",
        "description": "Upload an image to GridFS with optional compression",
        "tags": [
          "Images"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Image file to upload"
                  },
                  "full": {
                    "type": "boolean",
                    "description": "If true, upload without compression"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Image uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadedImage"
                }
              }
            }
          },
          "400": {
            "description": "No file uploaded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/miscellaneous/pdf-to-docx": {
      "post": {
        "summary": "OCR d'un PDF pour le rendre «recherchable» (texte sélectionnable)",
        "description": "Traite un fichier PDF avec OCR pour produire un PDF «recherchable» (texte sélectionnable) en conservant la mise en page.",
        "tags": [
          "Miscellaneous"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Le fichier PDF à convertir"
                  },
                  "language": {
                    "type": "string",
                    "default": "fra+eng",
                    "description": "Langue(s) pour l'OCR (ex fra, eng, fra+eng)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PDF recherchable généré avec succès",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Fichier PDF manquant",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Erreur lors de la conversion",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/miscellaneous/pdf-to-docx-stream": {
      "post": {
        "summary": "OCR d'un PDF (progression en temps réel) pour générer un PDF «recherchable»",
        "description": "Effectue l'OCR d'un fichier PDF (mise en page conservée) et renvoie un PDF «recherchable», avec suivi de progression via Server-Sent Events (SSE).\n\nÉvénements SSE retournés:\n- `progress`: { type: \"progress\", progress: number, message: string, pageCurrent?: number, pageTotal?: number, pagesRemaining?: number }\n- `complete`: { type: \"complete\", fileName: string, fileData: string (base64), mimeType: string }\n- `error`: { type: \"error\", message: string, error: string }\n",
        "tags": [
          "Miscellaneous"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Le fichier PDF à convertir"
                  },
                  "language": {
                    "type": "string",
                    "default": "fra+eng",
                    "description": "Langue(s) pour l'OCR (ex fra, eng, fra+eng)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stream SSE avec progression et fichier PDF en base64",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Fichier PDF manquant",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/miscellaneous/add-cover-page": {
      "post": {
        "summary": "Ajoute une page de garde à un PDF",
        "description": "Ajoute une page de garde personnalisée au début d'un PDF existant",
        "tags": [
          "Miscellaneous"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file",
                  "title",
                  "condominiumId"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Le fichier PDF"
                  },
                  "title": {
                    "type": "string",
                    "description": "Le titre à afficher sur la page de garde"
                  },
                  "condominiumId": {
                    "type": "string",
                    "description": "L'ID de la copropriété"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PDF avec page de garde généré avec succès",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Fichier PDF ou paramètres manquants",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Copropriété non trouvée",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Erreur lors de la génération",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/miscellaneous/vps-info": {
      "get": {
        "summary": "Récupère les informations du VPS Hostinger",
        "description": "Retourne les détails du VPS (status, ressources, utilisation) depuis l'API Hostinger",
        "tags": [
          "Miscellaneous"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Informations du VPS récupérées avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "VPS ID"
                    },
                    "name": {
                      "type": "string",
                      "description": "VPS name"
                    },
                    "status": {
                      "type": "string",
                      "description": "VPS status"
                    },
                    "hostname": {
                      "type": "string",
                      "description": "VPS hostname"
                    },
                    "ip": {
                      "type": "string",
                      "description": "IPv4 address"
                    },
                    "ipv6": {
                      "type": "string",
                      "description": "IPv6 address"
                    },
                    "os": {
                      "type": "string",
                      "description": "Operating system"
                    },
                    "location": {
                      "type": "string",
                      "description": "Server location"
                    },
                    "plan": {
                      "type": "object",
                      "description": "VPS plan details"
                    },
                    "usage": {
                      "type": "object",
                      "description": "Resource usage statistics"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Clé API invalide",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Erreur serveur ou clé API non configurée",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/report-structure": {
      "get": {
        "summary": "Get report structure by type",
        "tags": [
          "Report Structure"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "visit",
                "index",
                "reception",
                "sinister"
              ]
            },
            "description": "Report type (e.g., visit, index, reception, sinister)"
          }
        ],
        "responses": {
          "200": {
            "description": "Report structure data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportStructure"
                }
              }
            }
          },
          "400": {
            "description": "Missing type parameter",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report structure not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/report-structure/add": {
      "post": {
        "summary": "Add or create a new report structure",
        "tags": [
          "Report Structure"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReportStructure"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Report structure saved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportStructure"
                }
              }
            }
          },
          "400": {
            "description": "Missing type or data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/report-structure/{type}": {
      "patch": {
        "summary": "Update/patch an existing report structure",
        "tags": [
          "Report Structure"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report type identifier"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "Partial report structure data to merge"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Report structure updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportStructure"
                }
              }
            }
          },
          "400": {
            "description": "Missing type parameter or body data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report structure not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a report structure by type",
        "tags": [
          "Report Structure"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report type identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Report structure deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing type parameter",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report structure not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports": {
      "get": {
        "summary": "Get all reports",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of all reports",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Report"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/condominium/{id}": {
      "get": {
        "summary": "Get all reports for a specific condominium",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Condominium ID"
          }
        ],
        "responses": {
          "200": {
            "description": "List of reports for the condominium",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Report"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid condominium ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/download/{id}": {
      "get": {
        "summary": "Download a report as PDF",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "PDF file download",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Missing report ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/html/{id}": {
      "get": {
        "summary": "Get the pre-generated HTML content of a report",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "HTML content of the report",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Invalid report ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report or HTML not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update only the HTML content of a report",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "html"
                ],
                "properties": {
                  "html": {
                    "type": "string",
                    "description": "HTML content"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "HTML updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/{id}": {
      "get": {
        "summary": "Get a report by ID",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Report details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Report"
                }
              }
            }
          },
          "400": {
            "description": "Invalid report ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a report and its associated images",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Report deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing report ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update a report's data and regenerate HTML",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Report"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Report updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Report"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/add": {
      "post": {
        "summary": "Add a new report or update an existing one",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Report"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Report updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Report"
                }
              }
            }
          },
          "201": {
            "description": "Report created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Report"
                }
              }
            }
          },
          "400": {
            "description": "Missing required fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/reports/regenerate/{id}": {
      "post": {
        "summary": "Regenerate the HTML content for a report",
        "tags": [
          "Reports"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Report ID"
          }
        ],
        "responses": {
          "200": {
            "description": "HTML regenerated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing report ID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Report not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/roles": {
      "get": {
        "summary": "Get all roles",
        "tags": [
          "Roles"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of all roles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Role"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/roles/update_role": {
      "post": {
        "summary": "Replace all roles with the provided array",
        "tags": [
          "Roles"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Role"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Roles updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "summary": "Get API status and MongoDB connection info",
        "tags": [
          "Status"
        ],
        "responses": {
          "200": {
            "description": "API is up and MongoDB is connected",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "connected"
                    },
                    "dbName": {
                      "type": "string",
                      "example": "flcopro"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "API is up but MongoDB not connected",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "disconnected"
                    },
                    "message": {
                      "type": "string",
                      "example": "MongoDB not connected"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "summary": "Get all users",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/add_user": {
      "post": {
        "summary": "Create new user",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "Email already in use",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/pin": {
      "post": {
        "summary": "Pin a condominium for the current user",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "ID of the condominium to pin",
                    "example": "650f8c4d8b8c4f0012345678"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Condominium pinned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid condominium id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/unpin": {
      "delete": {
        "summary": "Unpin a condominium for the current user",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "condominiumId"
                ],
                "properties": {
                  "condominiumId": {
                    "type": "string",
                    "description": "ID of the condominium to unpin",
                    "example": "650f8c4d8b8c4f0012345678"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Condominium unpinned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid ids",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/{id}": {
      "delete": {
        "summary": "Delete a user by ID",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID to delete"
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "User ID is required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update a user by ID",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid fields",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/update_profile": {
      "put": {
        "summary": "Update user profile (firstname, lastname, avatar...)",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "firstname": {
                    "type": "string",
                    "description": "First name"
                  },
                  "lastname": {
                    "type": "string",
                    "description": "Last name"
                  },
                  "avatar": {
                    "type": "string",
                    "description": "Avatar (base64 or URL)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User profile updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/reset-password/{id}": {
      "put": {
        "summary": "Reset a user's password by ID",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "User ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "password"
                ],
                "properties": {
                  "password": {
                    "type": "string",
                    "description": "New password"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid user id",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/users/change-password": {
      "post": {
        "summary": "Change the current user password",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "currentPassword",
                  "newPassword"
                ],
                "properties": {
                  "currentPassword": {
                    "type": "string",
                    "description": "Current password"
                  },
                  "newPassword": {
                    "type": "string",
                    "description": "New password"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid current password",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  }
}